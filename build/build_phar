#!/bin/bash
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd $SCRIPT_DIR'/..'

# Clean existing Phar file
if [[ -f projectlint.phar ]]; then
    rm projectlint.phar
    echo "Removed existing projectlint.phar file."
fi

# Check for pharcc availability
if php pharcc.phar -V >/dev/null 2>&1; then
    COMMAND="php pharcc.phar"
    echo "Found phparcc.phar in project directory. Will use it to build projectlint.phar"
elif pharcc -V >/dev/null 2>&1; then
    COMMAND="pharcc"
    echo "Found phparcc command installed on this system. Will use it to build projectlint.phar"
else
    echo >&2 "Building Phar file requires pharcc but it's not installed.";
    echo >&2 "Aborting.";
    exit 1;
fi

# Build new Phar file
$COMMAND build
